const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/ModalProductsView-BKBbyamu.js","assets/index-CoKN0y7C.js","assets/index-X8xELvnT.css","assets/order-BZKZYepf.js","assets/chunk-R6AK6OQ4-D6HQW98L.js","assets/Icons-Ir8WEg-7.js"])))=>i.map(i=>d[i]);
import{r as s,W as se,I as ae,j as e,t as ne,i as le,b,a as re,s as U,_ as oe}from"./index-CoKN0y7C.js";import{i as ie,S as ce,d as M,a as z,C as k,b as F,m as R,P as ue,p as de,t as me,c as xe,e as fe,f as pe,g as he,h as ge}from"./Icons-Ir8WEg-7.js";import{a as je}from"./order-BZKZYepf.js";import{c as Ce}from"./chunk-J7I6W5JF-YZ2tu-UP.js";import{u as V}from"./chunk-R6AK6OQ4-D6HQW98L.js";function be(){const[u,w]=s.useState(null),[n,h]=s.useState(!1),[S,g]=s.useState(null);return s.useEffect(()=>{g(null),h(!0),je().then(j=>{w(j.data.data)}).catch(j=>{console.log(j),g(["Error al cargar las ordenes"])}).finally(()=>{h(!1)})},[]),{error:S,loading:n,orders:u,setOrders:w}}const we=s.lazy(()=>oe(()=>import("./ModalProductsView-BKBbyamu.js"),__vite__mapDeps([0,1,2,3,4,5])));function q(u){return u?u.charAt(0).toUpperCase()+u.slice(1).toLowerCase():""}const y=[{name:"USUARIO",uid:"username",sortable:!0},{name:"PRECIO TOTAL",uid:"totalAmount",sortable:!0},{name:"CANTIDAD DE PRODUCTOS",uid:"productquantity",sortable:!0},{name:"ESTADO",uid:"pending",sortable:!0},{name:"FECHA",uid:"createdAt"},{name:"ACTIONS",uid:"actions"}],$=[{name:"COMPLETADO",uid:"false"},{name:"PENDIENTE",uid:"true"}],Se={false:"success",true:"warning"},_e=["username","totalAmount","productquantity","createdAt","pending","actions"];function Oe(){const{error:u,loading:w,orders:n}=be(),h=se(),{isOpen:S,onOpen:g,onClose:j}=ae(),[d,N]=s.useState(""),[B,H]=s.useState(""),[C,K]=s.useState(new Set(_e)),[m,W]=s.useState("all"),[_,Y]=s.useState(10),[x,G]=s.useState({column:"name",direction:"ascending"}),[l,f]=s.useState(1),P=!!d,J=s.useMemo(()=>C==="all"?y:y.filter(t=>Array.from(C).includes(t.uid)),[C]),v=s.useMemo(()=>{if(!n)return[];let t=[...n];return P&&(t=t.filter(a=>{var r,i,c,o;return((i=(r=a.client)==null?void 0:r.baseUser)==null?void 0:i.username.toLowerCase().includes(d.toLowerCase()))||((o=(c=a.admin)==null?void 0:c.baseUser)==null?void 0:o.username.toLowerCase().includes(d.toLowerCase()))||a.totalAmount.toString().toLowerCase().includes(d.toLowerCase())})),m!=="all"&&Array.from(m).length!==$.length&&(t=t.filter(a=>Array.from(m).includes(String(a.pending)))),t},[n,P,m,d]),p=Math.ceil(v.length/_),Q=s.useMemo(()=>{const t=[...v].sort((i,c)=>{const o=i[x.column],T=c[x.column],L=o<T?-1:o>T?1:0;return x.direction==="descending"?-L:L}),a=(l-1)*_,r=a+_;return t.slice(a,r)},[v,l,_,x.column,x.direction]),X=t=>{const a=["enero","febrero","marzo","abril","mayo","junio","julio","agosto","septiembre","octubre","noviembre","diciembre"],r=new Date(t),i=r.getUTCDate(),c=a[r.getUTCMonth()],o=r.getUTCFullYear();return`${i} ${c} ${o}`},Z=s.useCallback((t,a)=>{var i,c,o;const r=t[a];switch(a){case"username":return t.client?e.jsx(V,{avatarProps:{radius:"lg",src:t.client.baseUser.image},name:(i=t.client)==null?void 0:i.baseUser.username}):e.jsx(V,{avatarProps:{radius:"lg",src:t.admin.baseUser.image},name:(o=(c=t.admin)==null?void 0:c.baseUser)==null?void 0:o.username});case"totalAmount":return e.jsx("div",{className:"flex flex-col",children:e.jsxs("p",{className:"text-bold text-small capitalize",children:[t.totalAmount,"$"]})});case"pending":return e.jsx(Ce,{className:"capitalize",color:Se[String(t.pending)],size:"sm",variant:"flat",children:t.pending?"Pendiente":"Completada"});case"productquantity":return e.jsx("span",{className:"font-semibold flex justify-center",children:t._count.orderItems});case"createdAt":return e.jsx("div",{children:e.jsx("p",{className:"text-bold text-small capitalize",children:X(t.createdAt)})});case"actions":return e.jsx("div",{className:"relative flex justify-center items-center gap-2",children:e.jsx(ne,{content:"Details",color:"success",children:e.jsx("span",{className:"text-lg text-success cursor-pointer active:opacity-50",children:e.jsx(ie,{onClick:()=>{g(),H(t.id)},color:"success"})})})});default:return String(r)}},[g]),A=s.useCallback(()=>{l<p&&f(l+1)},[l,p]),O=s.useCallback(()=>{l>1&&f(l-1)},[l]),E=s.useCallback(t=>{Y(Number(t.target.value)),f(1)},[]),I=s.useCallback(t=>{t?(N(t),f(1)):N("")},[]),D=s.useCallback(()=>{N(""),f(1)},[]),ee=s.useMemo(()=>{const t=()=>{h("/neworder")};return e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between gap-3 items-end ",children:[e.jsx(le,{isClearable:!0,color:"warning",className:"w-full sm:max-w-[44%]",placeholder:"Búsqueda...",startContent:e.jsx(ce,{}),value:d,onClear:()=>D(),onValueChange:I}),e.jsxs("div",{className:"flex gap-3 w-full justify-center sm:w-auto ",children:[e.jsxs(M,{children:[e.jsx(z,{children:e.jsx(b,{endContent:e.jsx(k,{className:"text-small"}),variant:"flat",children:"Estado"})}),e.jsx(F,{disallowEmptySelection:!0,"aria-label":"Table Columns",closeOnSelect:!1,selectedKeys:m,selectionMode:"multiple",onSelectionChange:W,children:$.map(a=>e.jsx(R,{className:"capitalize",children:q(a.name)},a.uid))})]}),e.jsxs(M,{children:[e.jsx(z,{children:e.jsx(b,{endContent:e.jsx(k,{className:"text-small"}),variant:"flat",children:"Columnas"})}),e.jsx(F,{disallowEmptySelection:!0,"aria-label":"Table Columns",closeOnSelect:!1,selectedKeys:C,selectionMode:"multiple",onSelectionChange:K,children:y.map(a=>e.jsx(R,{className:"capitalize",children:q(a.name)},a.uid))})]}),e.jsx(b,{color:"warning",endContent:e.jsx(ue,{}),onPress:t,children:"Nueva Orden"})]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("span",{className:"text-default-400 text-small",children:["Total ",n==null?void 0:n.length," Ordenes"]}),e.jsxs("label",{className:"flex items-center text-default-400 text-small",children:["Filas por páginas:",e.jsxs("select",{className:"bg-transparent outline-none text-default-400 text-small",onChange:E,children:[e.jsx("option",{value:"10",children:"10"}),e.jsx("option",{value:"15",children:"15"}),e.jsx("option",{value:"20",children:"20"})]})]})]})]})},[d,I,m,C,n==null?void 0:n.length,E,D,h]),te=s.useMemo(()=>e.jsxs("div",{className:"py-2 px-2 flex justify-between items-center",children:[e.jsx(de,{isCompact:!0,showControls:!0,showShadow:!0,color:"warning",page:l,total:p,onChange:f}),e.jsxs("div",{className:" justify-end gap-2",children:[e.jsx(b,{isDisabled:p===1,size:"md",variant:"flat",onPress:O,color:"danger",className:"mx-2",children:"Anterior"}),e.jsx(b,{isDisabled:p===1,size:"md",variant:"flat",onPress:A,color:"success",children:"Siguiente"})]})]}),[l,p,O,A]);return e.jsxs(e.Fragment,{children:[u&&u.map(t=>re.error(t)),S&&e.jsx(s.Suspense,{fallback:e.jsx("div",{className:"w-full flex justify-center fixed pt-2",children:e.jsx(U,{color:"warning"})}),children:e.jsx(we,{isOpen:S,onClose:j,id:B})}),e.jsxs(me,{isHeaderSticky:!0,"aria-label":"Example table with custom cells, pagination and sorting",bottomContent:te,bottomContentPlacement:"outside",classNames:{wrapper:"max-h-[600px]"},sortDescriptor:x,topContent:ee,topContentPlacement:"outside",onSortChange:G,children:[e.jsx(xe,{columns:J,children:t=>e.jsx(fe,{align:t.uid==="actions"||t.uid==="productquantity"||t.uid==="totalAmount"?"center":"start",allowsSorting:t.sortable,children:t.name},t.uid)}),e.jsx(pe,{isLoading:w,loadingContent:e.jsx(U,{color:"warning"}),emptyContent:"No se encontraron ordenes",items:Q,children:t=>e.jsx(he,{children:a=>e.jsx(ge,{children:Z(t,a)})},t.id)})]})]})}export{q as Capitalize,Oe as default};
