import{r as s,g as W,u as H,j as e,t as k,a as j,i as Y,b as S,s as G,d as J}from"./index-eclOOh3M.js";import{D as T,S as K,d as Q,a as X,C as Z,b as ee,m as te,p as se,t as ae,c as le,e as ne,f as re,g as oe,h as ie}from"./Icons-e4OENU1T.js";import{c as ce}from"./chunk-J7I6W5JF-BI9JWp_b.js";import{u as de}from"./chunk-R6AK6OQ4-DQ7-aWAR.js";function ue(){const[n,m]=s.useState(null),[b,h]=s.useState(null),[x,i]=s.useState(!1);return s.useEffect(()=>{h(null),i(!0),W().then(c=>{m(c.data)}).catch(c=>{console.log(c),h(["Error ela cargar los usuarios"])}).finally(()=>{i(!1)})},[]),{users:n,error:b,loading:x,setUsers:m}}function me(n){return n?n.charAt(0).toUpperCase()+n.slice(1).toLowerCase():""}const v=[{name:"NOMBRE",uid:"username",sortable:!0},{name:"Creado en: ",uid:"createdAt",sortable:!0},{name:"STATUS",uid:"status",sortable:!0},{name:"Número de Ordenes",uid:"order"},{name:"ACTIONS",uid:"actions"}],xe={true:"success",false:"danger"},fe=["username","status","actions","createdAt","order"];function be(){const{users:n,error:m,loading:b,setUsers:h}=ue(),{user:x}=H(),[i,c]=s.useState(""),[f,z]=s.useState(new Set(fe)),[g,L]=s.useState(10),[a,O]=s.useState(),[r,d]=s.useState(1),_=!!i,R=t=>{const l=["enero","febrero","marzo","abril","mayo","junio","julio","agosto","septiembre","octubre","noviembre","diciembre"],o=new Date(t),N=o.getUTCDate(),w=l[o.getUTCMonth()],p=o.getUTCFullYear();return`${N} ${w} ${p}`},F=s.useMemo(()=>f==="all"?v:v.filter(t=>Array.from(f).includes(t.uid)),[f]),C=s.useMemo(()=>{if(!n)return[];let t=[...n];return _&&(t=t.filter(l=>l.username.toLowerCase().includes(i.toLowerCase()))),t},[n,_,i]),u=Math.ceil(C.length/g),V=s.useMemo(()=>{const t=[...C].sort((N,w)=>{const p=N[a==null?void 0:a.column],E=w[a==null?void 0:a.column],M=p<E?-1:p>E?1:0;return(a==null?void 0:a.direction)==="descending"?-M:M}),l=(r-1)*g,o=l+g;return t.slice(l,o)},[C,r,g,a==null?void 0:a.column,a==null?void 0:a.direction]),B=t=>{J(t).then(()=>{j.success("Usuario eliminado con exito"),h(l=>l?l.filter(o=>o.userId!==t):null)}).catch(l=>{console.log(l),j.error("Error al eliminar el Usuario")})},q=s.useCallback((t,l)=>{const o=t[l];switch(l){case"username":return e.jsx(de,{avatarProps:{radius:"lg",src:t.image},name:e.jsx("span",{style:{display:"inline-block",maxWidth:"250px",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:t.username}),description:t.email});case"createdAt":return e.jsx("div",{className:"flex justify-center",children:e.jsx("p",{className:"text-bold text-small capitalize",children:R(t.createdAt)})});case"order":return e.jsx("div",{className:"flex justify-center",children:e.jsx("p",{className:"text-bold text-small capitalize",children:t.orderCount})});case"status":return e.jsx("div",{className:"w-full flex justify-center",children:e.jsx(ce,{className:"capitalize",color:xe[String(t.status)],size:"sm",variant:"flat",children:String(o)})});case"actions":return(x==null?void 0:x.role)==="OWNER"?e.jsx("div",{className:"relative flex justify-center items-center gap-2",children:e.jsx(k,{color:"danger",content:"Delete user",children:e.jsx("button",{onClick:()=>{B(t.userId)},className:"text-lg text-danger cursor-pointer active:opacity-50",children:e.jsx(T,{})})})}):e.jsx("div",{className:"relative flex justify-center items-center gap-2",children:e.jsx(k,{color:"danger",content:"Delete user",children:e.jsx("button",{onClick:()=>{j.error("Solo disponible para el Administrador")},className:"text-lg text-danger cursor-pointer active:opacity-50",children:e.jsx(T,{})})})});default:return String(o)}},[]),y=s.useCallback(()=>{r<u&&d(r+1)},[r,u]),P=s.useCallback(()=>{r>1&&d(r-1)},[r]),I=s.useCallback(t=>{console.log(t.target.value),L(Number(t.target.value)),d(1)},[]),U=s.useCallback(t=>{t?(c(t),d(1)):c("")},[]),A=s.useCallback(()=>{c(""),d(1)},[]),$=s.useMemo(()=>e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{className:"flex justify-between gap-3 items-end",children:[e.jsx(Y,{isClearable:!0,color:"primary",className:"w-full sm:max-w-[44%]",placeholder:"Búsqueda...",startContent:e.jsx(K,{}),value:i,onClear:()=>A(),onValueChange:U}),e.jsx("div",{className:"flex gap-3",children:e.jsxs(Q,{children:[e.jsx(X,{className:"",children:e.jsx(S,{endContent:e.jsx(Z,{className:"text-small"}),variant:"flat",children:"Columnas"})}),e.jsx(ee,{disallowEmptySelection:!0,"aria-label":"Table Columns",closeOnSelect:!1,selectedKeys:f,selectionMode:"multiple",onSelectionChange:z,children:v.map(t=>e.jsx(te,{className:"capitalize",children:me(t.name)},t.uid))})]})})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("span",{className:"text-default-400 text-small",children:["Total ",n==null?void 0:n.length," usuarios"]}),e.jsxs("label",{className:"flex items-center text-default-400 text-small",children:["Filas por páginas:",e.jsxs("select",{className:"bg-transparent outline-none text-default-400 text-small",onChange:I,children:[e.jsx("option",{value:"10",children:"10"}),e.jsx("option",{value:"15",children:"15"}),e.jsx("option",{value:"20",children:"20"})]})]})]})]}),[i,U,f,n==null?void 0:n.length,I,A]),D=s.useMemo(()=>e.jsxs("div",{className:"py-2 px-2 flex justify-between items-center",children:[e.jsx(se,{isCompact:!0,showControls:!0,showShadow:!0,color:"primary",page:r,total:u,onChange:d}),e.jsxs("div",{className:"justify-end gap-2",children:[e.jsx(S,{isDisabled:u===1,size:"md",variant:"flat",onPress:P,color:"danger",className:"mx-2",children:"Anterior"}),e.jsx(S,{isDisabled:u===1,size:"md",variant:"flat",onPress:y,color:"success",children:"Siguiente"})]})]}),[r,u,P,y]);return e.jsxs(e.Fragment,{children:[m&&m.map(t=>j.error(t)),e.jsxs(ae,{isHeaderSticky:!0,"aria-label":"Example table with custom cells, pagination and sorting",bottomContent:D,bottomContentPlacement:"outside",classNames:{wrapper:"max-h-[670px]"},color:"danger",sortDescriptor:a,topContent:$,topContentPlacement:"outside",onSortChange:O,children:[e.jsx(le,{columns:F,children:t=>e.jsx(ne,{align:t.uid==="actions"||t.uid==="createdAt"||t.uid==="order"||t.uid==="status"?"center":"start",allowsSorting:t.sortable,children:t.name},t.uid)}),e.jsx(re,{isLoading:b,loadingContent:e.jsx(G,{color:"white"}),emptyContent:"No users found",items:V,children:t=>e.jsx(oe,{children:l=>e.jsx(ie,{children:q(t,l)})},t.userId)})]})]})}export{me as Capitalize,be as default};
