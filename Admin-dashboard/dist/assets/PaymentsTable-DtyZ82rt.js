import{U as oe,r as a,a as Y,V as ie,j as e,x as de,y as ue,z as me,A as xe,s as A,N as fe,b as S,I as he,t as pe,i as je}from"./index-BvSoqA-Z.js";import{t as J,c as K,e as Q,f as W,g as X,h as Z,i as ge,S as be,d as R,a as q,C as V,b as $,m as B,p as Ce}from"./Icons-Dq4C29eR.js";import{g as Ne}from"./order-CAVT0cZf.js";import{u as O}from"./chunk-R6AK6OQ4-BfRhABQq.js";import{c as we}from"./chunk-J7I6W5JF-CIxxxe5A.js";const ye=()=>oe.get("/payment");function Se(){const[o,N]=a.useState(null),[c,m]=a.useState(!1),[w,p]=a.useState(null);return a.useEffect(()=>{ye().then(d=>{N(d.data.data)}).catch(d=>{console.log(d),p(["Error al cargar los Pagos"])}).finally(()=>{m(!1)})},[]),{payments:o,loading:c,error:w}}const ve=[{name:"NOMBRE",uid:"name"},{name:"CANTIDAD",uid:"quantity"},{name:"PRECIO TOTAL",uid:"totalPrice"}],Pe=({id:o,isOpen:N,onClose:c})=>{const[m,w]=a.useState(null),[p,d]=a.useState(!1);a.useEffect(()=>{d(!0),Ne(o).then(t=>{w(t.data.data.orderItems)}).catch(t=>{console.log(t),Y.error("Error al cargar los productos")}).finally(()=>{d(!1)})},[o]);const _=a.useMemo(()=>m||[],[m]),u=ie.useCallback((t,l)=>{const y=t[l];switch(l){case"name":return e.jsx(O,{avatarProps:{radius:"lg",src:t.product.imagen},description:e.jsx("div",{className:" flex items-center justify-center gap-2",children:e.jsx("div",{className:"flex items-center",children:e.jsx("div",{className:"flex text-yellow-500",children:[...Array(5)].map((x,v)=>e.jsx("svg",{className:`h-4 w-4 fill-current ${t.product.ratingAverage-.5>v?"text-yellow-500":"text-gray-300"}`,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",children:e.jsx("path",{d:"M10 15l-5.878 3.09 1.122-6.545L.368 6.91l6.564-.955L10 0l3.068 5.955 6.564.955-4.878 4.635 1.122 6.545z"})},v))})})}),name:t.product.name});case"quantity":return e.jsx("div",{className:"flex  justify-center",children:e.jsx("p",{className:"text-bold text-sm capitalize",children:t.quantity})});case"totalPrice":return e.jsx("div",{className:"flex justify-center ",children:e.jsx("p",{className:"text-bold text-sm capitalize",children:t.price})});default:return String(y)}},[]);return e.jsx(e.Fragment,{children:e.jsx(de,{classNames:{body:"px-1"},backdrop:"opaque",isOpen:N,onClose:c,size:"xl",children:e.jsx(ue,{children:t=>e.jsxs(e.Fragment,{children:[e.jsxs(me,{className:"flex items-end  space-x-2 gap-1 font-[sans-serif] ",children:[e.jsx("img",{src:"./logo.webp",alt:"Logo reycel",className:"w-10 h-8"}),e.jsx("h1",{className:"text-2xl font-bold",children:"Detalles del Pago"})]}),e.jsx(xe,{children:e.jsxs(J,{"aria-label":"Example table with custom cells",shadow:"none",isHeaderSticky:!0,classNames:{wrapper:"max-h-[500px] max-w-full"},children:[e.jsx(K,{columns:ve,children:l=>e.jsx(Q,{align:l.uid==="quantity"||l.uid==="totalPrice"?"center":"start",children:l.name},l.uid)}),e.jsx(W,{items:_,isLoading:p,loadingContent:e.jsx(A,{color:"warning"}),children:l=>e.jsx(X,{children:y=>e.jsx(Z,{children:u(l,y)})},l.id)})]})}),e.jsx(fe,{className:"flex min-w-full justify-end gap-3",children:e.jsx(S,{color:"danger",variant:"light",onPress:t,children:"Cancelar"})})]})})})})};function G(o){return o?o.charAt(0).toUpperCase()+o.slice(1).toLowerCase():""}const I=[{name:"USUARIO",uid:"user",sortable:!0},{name:"PRECIO TOTAL",uid:"price",sortable:!0},{name:"FAST DELIVERY",uid:"fastDelivery",sortable:!0},{name:"CANTIDAD DE PRODUCTOS",uid:"productquantity",sortable:!0},{name:"METODO DE PAGO",uid:"paymentMethod"},{name:"STATUS",uid:"status",sortable:!0},{name:"FECHA",uid:"date"},{name:"ACTIONS",uid:"actions"}],H=[{name:"COMPLETADO",uid:"COMPLETED"},{name:"PENDIENTE",uid:"PENDING"},{name:"CANCELADO",uid:"FAILED"}],_e={COMPLETED:"success",PENDING:"warning",FAILED:"danger"},Ee=["user","fastDelivery","price","productquantity","paymentMethod","date","idorder","status","actions"];function Me(){const{error:o,loading:N,payments:c}=Se(),[m,w]=a.useState(""),{isOpen:p,onOpen:d,onClose:_}=he(),[u,t]=a.useState(""),[l,y]=a.useState(new Set(Ee)),[x,v]=a.useState("all"),[P,ee]=a.useState(10),[n,se]=a.useState(),[i,j]=a.useState(1),L=!!u,ae=a.useMemo(()=>l==="all"?I:I.filter(s=>Array.from(l).includes(s.uid)),[l]),E=a.useMemo(()=>{if(!c)return[];let s=[...c];return L&&(s=s.filter(r=>r.client.baseUser.username.toLowerCase().includes(u.toLowerCase())||r.PaymentMethod.paymentOptions.toLowerCase().includes(u.toLowerCase())||r.paymentStatus.toLowerCase().includes(u.toLowerCase()))),x!=="all"&&Array.from(x).length!==H.length&&(s=s.filter(r=>Array.from(x).includes(r.paymentStatus))),s},[c,L,x,u]),g=Math.ceil(E.length/P),te=a.useMemo(()=>{const s=[...E].sort((b,C)=>{const h=b[n==null?void 0:n.column],F=C[n==null?void 0:n.column],k=h<F?-1:h>F?1:0;return(n==null?void 0:n.direction)==="descending"?-k:k}),r=(i-1)*P,f=r+P;return s.slice(r,f)},[E,i,P,n==null?void 0:n.column,n==null?void 0:n.direction]),le=s=>{const r=["enero","febrero","marzo","abril","mayo","junio","julio","agosto","septiembre","octubre","noviembre","diciembre"],f=new Date(s),b=f.getUTCDate(),C=r[f.getUTCMonth()],h=f.getUTCFullYear();return`${b} ${C} ${h}`},ne=a.useCallback((s,r)=>{var b,C,h;const f=s[r];switch(r){case"user":return s.client?e.jsx(O,{avatarProps:{radius:"lg",src:s.client.baseUser.image},name:(b=s.client)==null?void 0:b.baseUser.username}):e.jsx(O,{avatarProps:{radius:"lg",src:s.admin.baseUser.image},name:(h=(C=s.admin)==null?void 0:C.baseUser)==null?void 0:h.username});case"price":return e.jsx("div",{className:"flex flex-col",children:e.jsxs("p",{className:"text-bold text-small capitalize",children:[s.amount,"$"]})});case"productquantity":return e.jsx("div",{className:"flex flex-col",children:e.jsx("p",{className:"text-bold text-small capitalize",children:s.order._count.orderItems})});case"paymentMethod":return e.jsx("div",{className:"flex flex-col",children:e.jsx("p",{className:"text-bold text-small capitalize",children:s.PaymentMethod.paymentOptions})});case"status":return e.jsx(we,{className:"capitalize",color:_e[s.paymentStatus],size:"sm",variant:"flat",children:s.paymentStatus});case"date":return e.jsx("div",{children:e.jsx("p",{className:"text-bold text-small capitalize",children:le(s.createdAt)})});case"actions":return e.jsx("div",{className:"relative flex justify-center items-center gap-2",children:e.jsx(pe,{content:"Detalles",color:"success",children:e.jsx("span",{className:"text-lg text-success cursor-pointer active:opacity-50",children:e.jsx(ge,{onClick:()=>{d(),w(s.orderId)}})})})});default:return String(f)}},[d]),T=a.useCallback(()=>{i<g&&j(i+1)},[i,g]),M=a.useCallback(()=>{i>1&&j(i-1)},[i]),D=a.useCallback(s=>{ee(Number(s.target.value)),j(1)},[]),z=a.useCallback(s=>{s?(t(s),j(1)):t("")},[]),U=a.useCallback(()=>{t(""),j(1)},[]),re=a.useMemo(()=>e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between gap-3 items-end",children:[e.jsx(je,{isClearable:!0,className:"w-full sm:max-w-[44%]",color:"success",placeholder:"Búsqueda...",startContent:e.jsx(be,{}),value:u,onClear:()=>U(),onValueChange:z}),e.jsxs("div",{className:"flex gap-3 w-full justify-center sm:w-auto ",children:[e.jsxs(R,{children:[e.jsx(q,{children:e.jsx(S,{endContent:e.jsx(V,{className:"text-small"}),variant:"flat",children:"Estado"})}),e.jsx($,{disallowEmptySelection:!0,"aria-label":"Table Columns",closeOnSelect:!1,selectedKeys:x,selectionMode:"multiple",onSelectionChange:v,children:H.map(s=>e.jsx(B,{className:"capitalize",children:G(s.name)},s.uid))})]}),e.jsxs(R,{children:[e.jsx(q,{children:e.jsx(S,{endContent:e.jsx(V,{className:"text-small"}),variant:"flat",children:"Columnas"})}),e.jsx($,{disallowEmptySelection:!0,"aria-label":"Table Columns",closeOnSelect:!1,selectedKeys:l,selectionMode:"multiple",onSelectionChange:y,children:I.map(s=>e.jsx(B,{className:"capitalize",children:G(s.name)},s.uid))})]})]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("span",{className:"text-default-400 text-small",children:["Total ",c==null?void 0:c.length," pagos"]}),e.jsxs("label",{className:"flex items-center text-default-400 text-small",children:["Filas por páginas:",e.jsxs("select",{className:"bg-transparent outline-none text-default-400 text-small",onChange:D,children:[e.jsx("option",{value:"10",children:"10"}),e.jsx("option",{value:"15",children:"15"}),e.jsx("option",{value:"20",children:"20"})]})]})]})]}),[u,z,x,l,c==null?void 0:c.length,D,U]),ce=a.useMemo(()=>e.jsxs("div",{className:"py-2 px-2 flex justify-between items-center",children:[e.jsx(Ce,{isCompact:!0,showControls:!0,showShadow:!0,color:"success",page:i,total:g,onChange:j}),e.jsxs("div",{className:" justify-end gap-2",children:[e.jsx(S,{isDisabled:g===1,size:"md",variant:"flat",onPress:M,color:"danger",className:"mx-2",children:"Anterior"}),e.jsx(S,{isDisabled:g===1,size:"md",variant:"flat",onPress:T,color:"success",children:"Siguiente"})]})]}),[i,g,M,T]);return e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsx("h1",{className:"text-4xl font-medium text-left",children:"Tabla de Pagos"}),o&&o.map(s=>Y.error(s)),p&&e.jsx(a.Suspense,{fallback:e.jsx("div",{className:"w-full flex justify-center fixed pt-2",children:e.jsx(A,{color:"warning"})}),children:e.jsx(Pe,{isOpen:p,onClose:_,id:m})}),e.jsxs(J,{isHeaderSticky:!0,"aria-label":"Example table with custom cells, pagination and sorting",bottomContent:ce,bottomContentPlacement:"outside",classNames:{wrapper:"max-h-[600px]"},sortDescriptor:n,topContent:re,topContentPlacement:"outside",onSortChange:se,children:[e.jsx(K,{columns:ae,children:s=>e.jsx(Q,{align:s.uid==="actions"?"center":"start",allowsSorting:s.sortable,children:s.name},s.uid)}),e.jsx(W,{isLoading:N,loadingContent:e.jsx(A,{color:"success"}),emptyContent:"No hay pagos aún",items:te,children:s=>e.jsx(X,{children:r=>e.jsx(Z,{children:ne(s,r)})},s.id)})]})]})}export{G as Capitalize,Me as default};
